<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Second Course in Linear Algebra       -->
<!--                                              -->
<!-- Copyright (C) 2004-2014  Robert A. Beezer    -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="section-jordan-canonical-form">
    <title>Jordan Canonical Form</title>

    <introduction>
        <p>Nilpotent matrices and generalized eigenspaces are the essential ingredients for a canonical form applicable to any square matrix.  In this section will progress from the specialized case of a nilpotent matrix to the totally general case of any square matrix.</p>
    </introduction>

    <subsection xml:id="subsection-canonical-form-nilpotent">
        <title>Canonical Form for Nilpotent Linear Transformations</title>

        <p>Our main purpose in this section is to find a basis so that a nilpotent linear transformation will have a pleasing, nearly-diagonal matrix representation.  Of course, we will not have a definition for <q>pleasing,</q> nor for <q>nearly-diagonal.</q>  But the short answer is that our preferred matrix representation will be built up from Jordan blocks, <m>\jordan{k}{0}</m>.  Here's the theorem.  You will find Example<nbsp /><xref provisional="example-canonical-form-nilpotent-size-6-index-4" />, just following,  helpful as you study this proof, since it uses the same notation, and is large enough to (barely) illustrate the full generality of the theorem.</p>

        <!-- TODO: Corollary: s_i decrease (?) -->

        <theorem xml:id="theorem-canonical-form-nilpotent-linear-transformation"> <!-- was CFNLT -->
            <title>Canonical Form for Nilpotent Linear Transformations</title>
            <statement>
                <p>Suppose that <m>\ltdefn{T}{V}{V}</m> is a nilpotent linear transformation of index <m>p</m>.  Then there is a basis for <m>V</m> so that the matrix representation, <m>\matrixrep{T}{B}{B}</m>, is block diagonal with each block being a Jordan block, <m>\jordan{k}{0}</m>.  The size of the largest block is the index <m>p</m>, and the total number of blocks is the nullity of <m>T</m>, <m>\nullity{T}</m>.</p>
            </statement>

            <proof>
                <p>The proof is constructive, as we will explicitly manufacture the basis, and so can be used in practice.  As we begin, the basis vectors will not be in the proper order, but we will rearrange them at the end of the proof.  For convenience, define <m>n_i=\nullity{T^i}</m>, so for example, <m>n_0=0</m>, <m>n_1=\nullity{T}</m> and <m>n_p=\nullity{T^p}=\dimension{V}</m>.  Define <m>s_i=n_i-n_{i-1}</m>, for <m>1\leq i\leq p</m>, so we can think of <m>s_i</m> as <q>how much bigger</q> <m>\krn{T^i}</m> is than <m>\krn{T^{i-1}}</m>.  In particular, Theorem<nbsp /><xref ref="theorem-nilpotent-linear-transformation-kernels-of-powers" /> implies that <m>s_i\gt 0</m> for <m>1\leq i\leq p</m>.</p>

                <p>We build a set of vectors <m>\vect{z}_{i,j}</m>, <m>1\leq i\leq p</m>, <m>1\leq j\leq s_i</m>.  Each <m>\vect{z}_{i,j}</m> will be an element of <m>\krn{T^i}</m> and not an element of <m>\krn{T^{i-1}}</m>.  In total, we will obtain a linearly independent set of <m>\sum_{i=1}^{p}s_i=\sum_{i=1}^{p}n_i-n_{i-1}=n_p-n_0=\dimension{V}</m> vectors that form a basis of <m>V</m>.  We construct this set in pieces, starting at the <q>wrong</q> end.  Our procedure will build a series of subspaces, <m>Z_i</m>, each lying in between  <m>\krn{T^{i-1}}</m> and <m>\krn{T^i}</m>, having bases <m>\vect{z}_{i,j}</m>, <m>1\leq j\leq s_i</m>, and which together equal <m>V</m> as a direct sum.  Now would be a good time to review the results on direct sums collected in Section<nbsp /><xref ref="section-direct-sums" />.</p>

                <p>We build the subspace <m>Z_p</m> first (this is what we meant by <q>starting at the wrong end</q>).  <m>\krn{T^{p-1}}</m> is a proper subspace of <m>\krn{T^p}=V</m> (Theorem<nbsp /><xref ref="theorem-nilpotent-linear-transformation-kernels-of-powers" />).  Theorem<nbsp /><xref ref="theorem-direct-sum-from-one-subspace" /> says that there is a subspace of <m>V</m> that will pair with the subspace <m>\krn{T^{p-1}}</m> to form a direct sum of <m>V</m>.  Call this subspace <m>Z_p</m>, and choose vectors <m>\vect{z}_{p,j}</m>, <m>1\leq j\leq s_p</m> as a basis of <m>Z_p</m>, which we will denote as <m>B_p</m>.   Note that we have a fair amount of freedom in how to choose these first basis vectors.  Several observations will be useful in the next step.  First <m>V=\krn{T^{p-1}}\ds Z_p</m>.  The basis <m>B_p=\set{\vect{z}_{p,1},\,\vect{z}_{p,2},\,\vect{z}_{p,3},\,\dots,\,\vect{z}_{p,s_p}}</m> is linearly independent.  For <m>1\leq j\leq s_p</m>, <m>\vect{z}_{p,j}\in\krn{T^p}=V</m>.  Since the two subspaces of a direct sum have no nonzero vectors in common, for <m>1\leq j\leq s_p</m>, <m>\vect{z}_{p,j}\not\in\krn{T^{p-1}}</m>.  That was comparably easy.</p>

                <p>If obtaining <m>Z_p</m> was easy, getting <m>Z_{p-1}</m> will be harder.  We will repeat the next step <m>p-1</m> times, and so will do it carefully the first time.  Eventually, <m>Z_{p-1}</m> will have dimension <m>s_{p-1}</m>.  However, obtaining the first <m>s_p</m> vectors of a basis for <m>Z_{p-1}</m> are straightforward.  Define <m>\vect{z}_{p-1,j}=\lteval{T}{\vect{z}_{p,j}}</m>, <m>1\leq j\leq s_p</m>.  Notice that we have no choice in creating these vectors, they are a consequence of our choices for <m>\vect{z}_{p,j}</m>.  In retrospect (<ie /> on a second reading of this proof), you will recognize this as the key step in realizing a matrix representation of a nilpotent linear transformation with Jordan blocks.  We need to know that this set of vectors is linearly independent.  We consider a relation of linear dependence on <m>\vect{z}_{p-1,j}</m>, <m>1\leq j\leq s_p</m>, and massage it, <md>
                    <mrow>\zerovector&amp;=
                    a_1\vect{z}_{p-1,1}+
                    a_2\vect{z}_{p-1,2}+
                    a_3\vect{z}_{p-1,3}+
                    \cdots+
                    a_{s_p}\vect{z}_{p-1,s_p}</mrow>
                    <mrow>&amp;=
                    a_1\lteval{T}{\vect{z}_{p,1}}+
                    a_2\lteval{T}{\vect{z}_{p,2}}+
                    a_3\lteval{T}{\vect{z}_{p,3}}+
                    \cdots+
                    a_{s_p}\lteval{T}{\vect{z}_{p,s_p}}</mrow>
                    <mrow>&amp;=\lteval{T}{
                    a_1\vect{z}_{p,1}+
                    a_2\vect{z}_{p,2}+
                    a_3\vect{z}_{p,3}+
                    \cdots+
                    a_{s_p}\vect{z}_{p,s_p}
                    }</mrow>
                </md> Define <me>\vect{x}=a_1\vect{z}_{p,1}+a_2\vect{z}_{p,2}+a_3\vect{z}_{p,3}+\cdots+a_{s_p}\vect{z}_{p,s_p}</me> The statement just above means that <m>\vect{x}\in\krn{T}\subseteq\krn{T^{p-1}}</m>  (Theorem<nbsp /><xref ref="theorem-nilpotent-linear-transformation-kernels-of-powers" />).  As defined, <m>\vect{x}</m> is a linear combination of the basis vectors <m>B_p</m>, and therefore <m>\vect{x}\in Z_p</m>.  Thus <m>\vect{x}\in\krn{T^{p-1}}\cap Z_p</m>.  Because <m>V=\krn{T^{p-1}}\ds Z_p</m>, Theorem<nbsp /><xref ref="theorem-direct-sum-zero-intersection" /> tells us that <m>\vect{x}=\zerovector</m>.  Now we recognize the definition of <m>\vect{x}</m> as a relation of linear dependence on the linearly independent set <m>B_p</m>, and therefore conclude that <m>a_1=a_2=\cdots=a_{s_p}=0</m>. This establishes the linear independence of <m>\vect{z}_{p-1,j}</m>, <m>1\leq j\leq s_p</m>.</p>

                <p>We also need to know where the vectors <m>\vect{z}_{p-1,j}</m>, <m>1\leq j\leq s_p</m> live.  First we demonstrate that they are members of <m>\krn{T^{p-1}}</m>. <me>\lteval{T^{p-1}}{\vect{z}_{p-1,j}}
                =\lteval{T^{p-1}}{\lteval{T}{\vect{z}_{p,j}}}
                =\lteval{T^{p}}{\vect{z}_{p,j}}
                =\zerovector</me>  So <m>\vect{z}_{p-1,j}\in\krn{T^{p-1}}</m>, <m>1\leq j\leq s_p</m>.</p>

                <p>Moreover, these vectors are not elements of <m>\krn{T^{p-2}}</m>.  Suppose to the contrary that <m>\vect{z}_{p-1,j}\in\krn{T^{p-2}}</m>.  Then <me>\zerovector
                =\lteval{T^{p-2}}{\vect{z}_{p-1,j}}
                =\lteval{T^{p-2}}{\lteval{T}{\vect{z}_{p,j}}}
                =\lteval{T^{p-1}}{\vect{z}_{p,j}}</me> which contradicts the earlier statement that <m>\vect{z}_{p,j}\not\in\krn{T^{p-1}}</m>.  So <m>\vect{z}_{p-1,j}\not\in\krn{T^{p-2}}</m>, <m>1\leq j\leq s_p</m>.</p>

                <p>Now choose any basis <m>C_{p-2}=\set{\vectorlist{u}{n_{p-2}}}</m> for <m>\krn{T^{p-2}}</m>.  We want to extend this basis by adding in the <m>\vect{z}_{p-1,j}</m> to span a subspace of <m>\krn{T^{p-1}}</m>.  But first we establish that this set is linearly independent.  Let <m>a_k</m>, <m>1\leq k\leq n_{p-2}</m> and <m>b_j</m>, <m>1\leq j\leq s_p</m> be the scalars in a relation of linear dependence, <me>\zerovector=
                a_1\vect{u}_1+
                a_2\vect{u}_2+
                \cdots+
                a_{n_{p-2}}\vect{u}_{n_{p-2}}
                +
                b_1\vect{z}_{p-1,1}+
                b_2\vect{z}_{p-1,2}+
                \cdots+
                b_{s_p}\vect{z}_{p-1,s_p} </me>  Then, <md>
                    <mrow>\zerovector
                    &amp;=\lteval{T^{p-2}}{\zerovector}</mrow>
                    <mrow>&amp;=\lteval{T^{p-2}}{
                    a_1\vect{u}_1+
                    a_2\vect{u}_2+
                    \cdots+
                    a_{n_{p-2}}\vect{u}_{n_{p-2}}
                    +
                    b_1\vect{z}_{p-1,1}+
                    b_2\vect{z}_{p-1,2}+
                    \cdots+
                    b_{s_p}\vect{z}_{p-1,s_p}
                    }</mrow>
                    <mrow>&amp;=
                    a_1\lteval{T^{p-2}}{\vect{u}_1}+
                    a_2\lteval{T^{p-2}}{\vect{u}_2}+
                    \cdots+
                    a_{n_{p-2}}\lteval{T^{p-2}}{\vect{u}_{n_{p-2}}}
                    +</mrow>
                    <mrow>&amp;\quad\quad
                    b_1\lteval{T^{p-2}}{\vect{z}_{p-1,1}}+
                    b_2\lteval{T^{p-2}}{\vect{z}_{p-1,2}}+
                    \cdots+
                    b_{s_p}\lteval{T^{p-2}}{\vect{z}_{p-1,s_p}}</mrow>
                    <mrow>&amp;=
                    a_1\zerovector+
                    a_2\zerovector+
                    \cdots+
                    a_{n_{p-2}}\zerovector
                    +</mrow>
                    <mrow>&amp;\quad\quad
                    b_1\lteval{T^{p-2}}{\vect{z}_{p-1,1}}+
                    b_2\lteval{T^{p-2}}{\vect{z}_{p-1,2}}+
                    \cdots+
                    b_{s_p}\lteval{T^{p-2}}{\vect{z}_{p-1,s_p}}</mrow>
                    <mrow>&amp;=
                    b_1\lteval{T^{p-2}}{\vect{z}_{p-1,1}}+
                    b_2\lteval{T^{p-2}}{\vect{z}_{p-1,2}}+
                    \cdots+
                    b_{s_p}\lteval{T^{p-2}}{\vect{z}_{p-1,s_p}}</mrow>
                    <mrow>&amp;=
                    b_1\lteval{T^{p-2}}{\lteval{T}{\vect{z}_{p,1}}}+
                    b_2\lteval{T^{p-2}}{\lteval{T}{\vect{z}_{p,2}}}+
                    \cdots+
                    b_{s_p}\lteval{T^{p-2}}{\lteval{T}{\vect{z}_{p,s_p}}}</mrow>
                    <mrow>&amp;=
                    b_1\lteval{T^{p-1}}{\vect{z}_{p,1}}+
                    b_2\lteval{T^{p-1}}{\vect{z}_{p,2}}+
                    \cdots+
                    b_{s_p}\lteval{T^{p-1}}{\vect{z}_{p,s_p}}</mrow>
                    <mrow>&amp;=
                    \lteval{T^{p-1}}{
                    b_1\vect{z}_{p,1}+
                    b_2\vect{z}_{p,2}+
                    \cdots+
                    b_{s_p}\vect{z}_{p,s_p}
                    }</mrow>
                </md> Define <me>\vect{y}= b_1\vect{z}_{p,1}+b_2\vect{z}_{p,2}+\cdots+b_{s_p}\vect{z}_{p,s_p}</me>  The statement just above means that <m>\vect{y}\in\krn{T^{p-1}}</m>.  As defined, <m>\vect{y}</m> is a linear combination of the basis vectors <m>B_p</m>, and therefore <m>\vect{y}\in Z_p</m>.  Thus <m>\vect{y}\in\krn{T^{p-1}}\cap Z_p</m>.  Because <m>V=\krn{T^{p-1}}\ds Z_p</m>, Theorem<nbsp /><xref ref="theorem-direct-sum-zero-intersection" /> tells us that <m>\vect{y}=\zerovector</m>.  Now we recognize the definition of <m>\vect{y}</m> as a relation of linear dependence on the linearly independent set <m>B_p</m>, and therefore <m>b_1=b_2=\cdots=b_{s_p}=0</m>.  Return to the full relation of linear dependence with both sets of scalars (the <m>a_i</m> and <m>b_j</m>).  Now that we know that <m>b_j=0</m> for <m>1\leq j\leq s_p</m>, this relation of linear dependence simplifies to a relation of linear dependence on just the basis <m>C_{p-1}</m>.  Therefore, <m>a_i=0</m>, <m>1\leq a_i\leq n_{p-1}</m> and we have the desired linear independence.</p>

                <p>Define a new subspace of <m>\krn{T^{p-1}}</m> by <me>Q_{p-1}=
                \spn{\set{
                \vectorlist{u}{n_{p-1}},\,
                \vect{z}_{p-1,1},\,\vect{z}_{p-1,2},\,\vect{z}_{p-1,3},\,\dots,\,\vect{z}_{p-1,s_p}
                }}</me> By Theorem<nbsp /><xref ref="theorem-direct-sum-from-one-subspace" /> there exists a subspace of <m>\krn{T^{p-1}}</m> which will pair with <m>Q_{p-1}</m> to form a direct sum.  Call this subspace <m>R_{p-1}</m>, so by definition, <m>\krn{T^{p-1}}=Q_{p-1}\ds R_{p-1}</m>.  We are interested in the dimension of <m>R_{p-1}</m>.  Note first, that since the spanning set of <m>Q_{p-1}</m> is linearly independent, <m>\dimension{Q_{p-1}}=n_{p-2}+s_p</m>.  Then <md>
                    <mrow>\dimension{R_{p-1}}&amp;=\dimension{\krn{T^{p-1}}}-\dimension{Q_{p-1}}</mrow>
                    <mrow>&amp;=n_{p-1}-\left(n_{p-2}+s_p\right) =\left(n_{p-1}-n_{p-2}\right)-s_p =s_{p-1}-s_p</mrow>
                </md>  Notice that if <m>s_{p-1}=s_p</m>, then <m>R_{p-1}</m> is trivial.   Now choose a basis of <m>R_{p-1}</m>, and denote these <m>s_{p-1}-s_p</m> vectors as <m>\vect{z}_{p-1,s_p+1}</m>, <m>\vect{z}_{p-1,s_p+2}</m>, <m>\vect{z}_{p-1,s_p+3}</m>, \dots, <m>\vect{z}_{p-1,s_{p-1}}</m>.  This is another occassion to notice that we have some freedom in this choice.</p>
                <p>We now have <m>\krn{T^{p-1}}=Q_{p-1}\ds R_{p-1}</m>, and we have bases for each of the two subspaces.  The union of these two bases will therefore be a linearly independent set in <m>\krn{T^{p-1}}</m> with size <md>
                    <mrow>\left(n_{p-2}+s_p\right)+\left(s_{p-1}-s_p\right)&amp;=n_{p-2}+s_{p-1}=n_{p-2}+n_{p-1}-n_{p-2}</mrow>
                    <mrow>&amp;=n_{p-1}=\dimension{\krn{T^{p-1}}}</mrow>
                </md>  So with the proper size the following set is a basis of <m>\krn{T^{p-1}}</m>,<me>\set{
                \vect{u}_1,\,\vect{u}_2,\,\dots,\,\vect{u}_{n_{p-2}},\,
                \vect{z}_{p-1,1},\,\vect{z}_{p-1,2},\,\dots,\,\vect{z}_{p-1,s_p},\,
                \vect{z}_{p-1,s_p+1},\,\vect{z}_{p-1,s_p+2},\,\dots,\,\vect{z}_{p-1,s_{p-1}}
                }</me>  We built up this basis in three parts, we will now split it in half.  Define the subspace <m>Z_{p-1}</m> by<me>Z_{p-1}=\spn{B_{p-1}}=
                \spn{\set{
                \vect{z}_{p-1,1},\,\vect{z}_{p-1,2},\,\dots,\,\vect{z}_{p-1,s_{p-1}}
                }}</me> where we have implicitly denoted the basis as <m>B_{p-1}</m>.  Then <xref ref="theorem-direct-sum-split-basis" /> allows us to split up the basis for <m>\krn{T^{p-1}}</m> as <m>C_{p-1}\cup B_{p-1}</m> and write <me>\krn{T^{p-1}}=\krn{T^{p-2}}\ds Z_{p-1}></me>  Whew!  This is a good place to recap what we have achieved.  The vectors <m>\vect{z}_{i,j}</m> form bases for the subspaces <m>Z_i</m> and right now <me>V=\krn{T^{p-1}}\ds Z_{p}=\krn{T^{p-2}}\ds Z_{p-1}\ds Z_{p}</me></p>

                <p>The key feature of this decomposition of <m>V</m> is that the first <m>s_p</m> vectors in the basis for <m>Z_{p-1}</m> are outputs of the linear transformation <m>T</m> using the basis vectors of <m>Z_p</m> as inputs.</p>

                <p>Now we want to further decompose <m>\krn{T^{p-2}}</m>, into <m>\krn{T^{p-3}}</m> and <m>Z_{p-2}</m>.  The procedure is the same as above, so we will only sketch the key steps.  Checking the details proceeds in the same manner as above.  Technically, we could have set up the preceding as the induction step in a proof by induction (<acroref type="technique" acro="I" />), but this probably would make the proof harder to understand.</p>

                <p>Apply <m>T</m> to each element of <m>B_{p-1}</m>, to create vectors <m>\vect{z}_{p-2,j}</m>, <m>1\leq j\leq s_{p-1}</m>.  These vectors form a linearly independent set, and each is an element of <m>\krn{T^{p-2}}</m>, but not an element of <m>\krn{T^{p-3}}</m>.  Grab a basis <m>C_{p-3}</m> of <m>\krn{T^{p-3}}</m> and add on the newly-created vectors <m>\vect{z}_{p-2,j}</m>, <m>1\leq j\leq s_{p-1}</m>.  This expanded set is linearly independent, and we can define a subspace <m>Q_{p-2}</m> with this set as its basis.  Theorem<nbsp /><xref ref="theorem-direct-sum-from-one-subspace" /> gives us a subspace <m>R_{p-2}</m> such that <m>\krn{T^{p-2}}=Q_{p-2}\ds R_{p-2}</m>.  Vectors <m>\vect{z}_{p-2,j}</m>, <m>s_{p-1}+1\leq j\leq s_{p-2}</m> are chosen as a basis for <m>R_{p-2}</m> once the relevant dimensions have been verified.  The union of <m>C_{p-3}</m> and <m>\vect{z}_{p-2,j}</m>, <m>1\leq j\leq s_{p-2}</m> then form a basis of <m>\krn{T^{p-2}}</m>, which can be split into two parts to yield the decomposition <me>\krn{T^{p-2}}=\krn{T^{p-3}}\ds Z_{p-2}</me>  Here <m>Z_{p-2}</m> is the subspace of <m>\krn{T^{p-2}}</m> with basis <m>B_{p-2}=\setparts{\vect{z}_{p-2,j}}{1\leq j\leq s_{p-2}}</m>.  Finally, <me>V=\krn{T^{p-1}}\ds Z_{p}=\krn{T^{p-2}}\ds Z_{p-1}\ds Z_{p}=\krn{T^{p-3}}\ds Z_{p-2}\ds Z_{p-1}\ds Z_{p}</me></p>

                <p>Again, the key feature of this decomposition is that the first vectors in the basis of <m>Z_{p-2}</m> are outputs of <m>T</m> using vectors from the basis <m>Z_{p-1}</m> as inputs (and in turn, some of these inputs are outputs of <m>T</m> derived from inputs in <m>Z_p</m>).</p>

                <p>Now assume we repeat this procedure until we decompose <m>\krn{T^{2}}</m> into subspaces <m>\krn{T}</m> and <m>Z_2</m>.  Finally, decompose <m>\krn{T}</m> into subspaces <m>\krn{T^0}=\krn{I_n}=\set{\zerovector}</m> and <m>Z_1</m>, so that we recognize the vectors <m>\vect{z}_{1,j}</m>, <m>1\leq j\leq s_1=n_1</m> as elements of <m>\krn{T}</m>.  The set <me>B=B_1\cup B_2\cup B_3\cup\cdots\cup B_p=\setparts{\vect{z}_{i,j}}{1\leq i\leq p,\ 1\leq j\leq s_i}</me> is linearly independent by Theorem<nbsp /><xref ref="theorem-direct-sums-linear-independence" /> and has size <me>\sum_{i=1}^{p}s_i=\sum_{i=1}^{p}n_i-n_{i-1}=n_p-n_0=\dimension{V}</me>  So <m>B</m> is a basis of <m>V</m>.</p>

                <p>We desire a matrix representation of <m>T</m> relative to <m>B</m>, but first we will reorder the elements of <m>B</m>.  The following display lists the elements of <m>B</m> in the desired order, when read across the rows left-to-right in the usual way.  Notice that we established the existence of these vectors column-by-column, and beginning on the right.<md>
                    <mrow><![CDATA[&\krn{T}           &&\krn{T^2}         &&\krn{T^3}         &&\cdots&&\krn{T^p}]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,1}    &&\vect{z}_{2,1}    &&\vect{z}_{3,1}    &&\cdots&&\vect{z}_{p,1}]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,2}    &&\vect{z}_{2,2}    &&\vect{z}_{3,2}    &&\cdots&&\vect{z}_{p,2}]]></mrow>
                    <mrow><![CDATA[&\vdots            &&\vdots            &&\vdots            &&\vdots&&\vdots]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,s_p}  &&\vect{z}_{2,s_p}  &&\vect{z}_{3,s_p}  &&\cdots&&\vect{z}_{p,s_p}]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,s_p+1}&&\vect{z}_{2,s_p+1}&&\vect{z}_{3,s_p+1}&&\cdots&&]]></mrow>
                    <mrow><![CDATA[&\vdots            &&\vdots            &&\vdots            &&\vdots&&]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,s_3}  &&\vect{z}_{2,s_3}  &&\vect{z}_{3,s_3}  &&      &&]]></mrow>
                    <mrow><![CDATA[&\vdots            &&\vdots            &&                  &&      &&]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,s_2}  &&\vect{z}_{2,s_2}  &&                  &&      &&]]></mrow>
                    <mrow><![CDATA[&\vdots            &&                  &&                  &&      &&]]></mrow>
                    <mrow><![CDATA[&\vect{z}_{1,s_1}  &&                  &&                  &&      && ]]></mrow> 
                </md> It is difficult to layout this table with the notation we have been using, but it would not be especially useful to invent some notation to overcome the difficulty. (One approach would be to define something like the inverse of the nonincreasing function, <m>i\rightarrow s_i</m>.)  Do notice that there are <m>s_1=n_1</m> rows, and <m>p</m> columns.  Column <m>i</m> is the basis <m>B_i</m>.  The vectors in the first column are elements of <m>\krn{T}</m>.  Each row is the same length, or shorter, than the one above it.  If we apply <m>T</m> to any vector in the table, other than those in the first column, the output is the preceding vector in the row.</p>

                <p>Now contemplate the matrix representation of <m>T</m> relative to <m>B</m> as we read across the rows of the table above.  In the first row, <m>\lteval{T}{\vect{z}_{1,1}}=\zerovector</m>, so the first column of the representation is the zero column.  Next, <m>\lteval{T}{\vect{z}_{2,1}}=\vect{z}_{1,1}</m>, so the second column of the representation is a vector with a single one in the first entry, and zeros elsewhere.  Next, <m>\lteval{T}{\vect{z}_{3,1}}=\vect{z}_{2,1}</m>, so column 3 of the representation is a zero, then a one, then all zeros.  Continuing in this vein, we obtain the first <m>p</m> columns of the representation, which is the Jordan block <m>\jordan{p}{0}</m> followed by rows of zeros.</p>

                <p>When we apply <m>T</m> to the basis vectors of the second row, what happens?  Applying <m>T</m> to the first vector, the result is the zero vector, so the representation gets a zero column.  Applying <m>T</m> to the second vector in the row, the output is simply the first vector in that row, making the next column of the representation all zeros plus a lone one, sitting just above the diagonal.  Continuing, we create a Jordan block, sitting on the diagonal of the matrix representation.  It is not possible in general to state the size of this block, but since the second row is no longer than the first, it cannot have size larger than <m>p</m>.</p>

                <!-- TODO: Describe the sizes of the blocks in terms of n_i, "The size of successive blocks" -->

                <p>Since there are as many rows as the dimension of <m>\krn{T}</m>, the representation contains as many Jordan blocks as the nullity of <m>T</m>, <m>\nullity{T}</m>.  Each successive block is smaller than the preceding one, with the first, and largest, having size <m>p</m>.  The blocks are Jordan blocks since the basis vectors <m>\vect{z}_{i,j}</m> were often defined as the result of applying <m>T</m> to other elements of the basis already determined, and then we rearranged the basis into an order that placed outputs of <m>T</m> just before their inputs, excepting the start of each row, which was an element of <m>\krn{T}</m>.</p>
            </proof>
        </theorem>

        <p>The proof of Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> is constructive, so we can use it to create bases of nilpotent linear transformations with pleasing matrix representations.  Recall that Theorem<nbsp /><xref ref="theorem-nilpotent-linear-transformation-diagonalizable" /> told us that nilpotent linear transformations are almost never diagonalizable, so this is progress.  As we have hinted before, with a nice representation of nilpotent matrices, it will not be difficult to build up representations of other non-diagonalizable matrices.  Here is the promised example which illustrates the previous theorem.  It is a useful companion to your study of the proof of Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />.</p>

        <example ref="example-canonical-form-nilpotent-size-6-index-4"> <!-- was CFNLT -->
            <title>Canonical Form for a Nilpotent Linear Transformation</title>

            <p>The <m>6\times 6</m> matrix, <m>A</m>, of Example<nbsp /><xref ref="example-nilpotent-matrix-size-6-index-4" /> is nilpotent.  If we define the linear transformation <m>\ltdefn{T}{\complex{6}}{\complex{6}}</m> by <m>\lteval{T}{\vect{x}}=A\vect{x}</m>, then <m>T</m> is nilpotent and we can seek a basis of <m>\complex{6}</m> that yields a matrix representation with Jordan blocks on the diagonal.   Since <m>T</m> has index <m>4</m> and nullity <m>2</m>, from Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> we can expect the largest Jordan block to be <m>\jordan{4}{0}</m>, and there will be just <m>2</m> blocks.  This only leaves enough room for the second block to have size <m>2</m>.</p>

            <p>To determine nullities, we will recycle the bases for the null spaces of the powers of <m>A</m> from Example<nbsp /><xref ref="example-nilpotent-linear-transformation-kernels" />, rather than recomputing them.  We will also use the same notation used in the proof of Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />.</p>

            <p>To begin, <m>s_4=n_4-n_3=6-5=1</m>, so we need one vector of <m>\krn{T^4}=\complex{6}</m>, that is not in <m>\krn{T^3}</m>, to be a basis for <m>Z_4</m>.  We have a lot of latitude in this choice, and we have not described any sure-fire method for constructing a vector <em>outside</em> of a subspace.  Looking at the basis for <m>\krn{T^3}</m> we see that if a vector is in this subspace, and has a nonzero value in the first entry, then it must also have a nonzero value in the fourth entry.  So the vector <me>\vect{z}_{4,1}=\colvector{1\\0\\0\\0\\0\\0}</me> will not be an element of <m>\krn{T^3}</m>.  (Notice that many other choices could be made here, so our basis will not be unique.)  This completes the determination of <m>Z_p=Z_4</m>.</p>

            <p>Next, <m>s_3=n_3-n_2=5-4=1</m>, so we again need just a single basis vector for <m>Z_3</m>.  We start by evaluating <m>T</m> with each basis vector of <m>Z_4</m>, <me>\vect{z}_{3,1}=\lteval{T}{\vect{z}_{4,1}}=A\vect{z}_{4,1}=\colvector{-3\\-3\\-3\\-3\\-3\\-2}</me>  Since <m>s_3=s_4</m>, the subspace <m>R_3</m> is trivial, and there is nothing left to do, <m>\vect{z}_{3,1}</m> is the lone basis vector of <m>Z_3</m>.</p>

            <p>Now <m>s_2=n_2-n_1=4-2=2</m>, so the construction of <m>Z_2</m> will not be as simple as the construction of <m>Z_3</m>.  We first apply <m>T</m> to the basis vector of <m>Z_2</m>,  <me>\vect{z}_{2,1}=\lteval{T}{\vect{z}_{3,1}}=A\vect{z}_{3,1}=\colvector{1\\0\\3\\1\\0\\-1}</me>  The two basis vectors of <m>\krn{T^1}</m>, together with <m>\vect{z}_{2,1}</m>, form a basis for <m>Q_2</m>.  Because <m>\dimension{\krn{T^2}}-\dimension{Q_2}=4-3=1</m> we need only find a single basis vector for <m>R_2</m>.  This vector must be an element of <m>\krn{T^2}</m>, but not an element of <m>Q_2</m>.  Again, there is a variety of vectors that fit this description, and we have no precise algorithm for finding them.  Since they are plentiful, they are not too hard to find.  We add up the four basis vectors of <m>\krn{T^2}</m>, ensuring an element of <m>\krn{T^2}</m>.  Then we check to see if the vector is a linear combination of three vectors:  the two basis vectors of <m>\krn{T^1}</m> and <m>\vect{z}_{2,1}</m>.  Having passed the tests, we have chosen  <me>\vect{z}_{2,2}=\colvector{2\\1\\2\\2\\2\\1}</me>  Thus, <m>Z_2=\spn{\set{\vect{z}_{2,1},\,\vect{z}_{2,2}}}</m>.</p>

            <p>Lastly, <m>s_1=n_1-n_0=2-0=2</m>.  Since <m>s_2=s_1</m>, we again have a trivial <m>R_1</m> and need only complete our basis by evaluating the basis vectors of <m>Z_2</m> with <m>T</m>, <md>
                <mrow>\vect{z}_{1,1}&amp;=\lteval{T}{\vect{z}_{2,1}}=A\vect{z}_{2,1}=\colvector{1\\1\\0\\1\\1\\1}
                &amp;
                \vect{z}_{1,2}&amp;=\lteval{T}{\vect{z}_{2,2}}=A\vect{z}_{2,2}=\colvector{-2\\-2\\-5\\-2\\-1\\0}</mrow>
            </md>  Now we reorder these vectors as the desired basis,<me>B=\set{
            \vect{z}_{1,1},\,\vect{z}_{2,1},\,\vect{z}_{3,1},\,\vect{z}_{4,1},\,\vect{z}_{1,2},\,\vect{z}_{2,2}}</me></p>

            <p>We now apply <acroref type="definition" acro="MR" /> to build a matrix representation of <m>T</m> relative to <m>B</m>,<md>
                <mrow>\vectrep{B}{\lteval{T}{\vect{z}_{1,1}}}&amp;=\vectrep{B}{A\vect{z}_{1,1}}=\vectrep{B}{\zerovector}=\colvector{0\\0\\0\\0\\0\\0}</mrow>
                <mrow>\vectrep{B}{\lteval{T}{\vect{z}_{2,1}}}&amp;=\vectrep{B}{A\vect{z}_{2,1}}=\vectrep{B}{\vect{z}_{1,1}}=\colvector{1\\0\\0\\0\\0\\0}</mrow>
                <mrow>\vectrep{B}{\lteval{T}{\vect{z}_{3,1}}} &amp;=\vectrep{B}{A\vect{z}_{3,1}}=\vectrep{B}{\vect{z}_{2,1}}=\colvector{0\\1\\0\\0\\0\\0}</mrow>
                <mrow>\vectrep{B}{\lteval{T}{\vect{z}_{4,1}}} &amp;=\vectrep{B}{A\vect{z}_{4,1}}=\vectrep{B}{\vect{z}_{3,1}}=\colvector{0\\0\\1\\0\\0\\0}</mrow>
                <mrow>\vectrep{B}{\lteval{T}{\vect{z}_{1,2}}} &amp;=\vectrep{B}{A\vect{z}_{1,2}}=\vectrep{B}{\zerovector}=\colvector{0\\0\\0\\0\\0\\0}</mrow>
                <mrow>\vectrep{B}{\lteval{T}{\vect{z}_{2,2}}}&amp;=\vectrep{B}{A\vect{z}_{2,2}}=\vectrep{B}{\vect{z}_{1,2}}=\colvector{0\\0\\0\\0\\1\\0}</mrow>
            </md></p>

            <p>Installing these vectors as the columns of the matrix representation we have <me>\matrixrep{T}{B}{B}=
            \begin{bmatrix}
            <![CDATA[ 0 & 1 & 0 & 0 & 0 & 0 \\
             0 & 0 & 1 & 0 & 0 & 0 \\
             0 & 0 & 0 & 1 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 1 \\
             0 & 0 & 0 & 0 & 0 & 0]]>
            \end{bmatrix}</me>  which is a block diagonal matrix with Jordan blocks <m>\jordan{4}{0}</m> and <m>\jordan{2}{0}</m>.</p>

            <p>If we construct the matrix <m>S</m> having the vectors of <m>B</m> as columns, then <acroref type="theorem" acro="SCB" /> tells us that a similarity transformation by <m>S</m> relates the original matrix representation of <m>T</m> with the matrix representation consisting of Jordan blocks, in other words, <m>\similar{A}{S}=\matrixrep{T}{B}{B}</m>.</p>
        </example>

        <!-- TODO: A more complicated nilpotent matrix canonical form -->

        <p>Notice that constructing interesting examples of matrix representations requires domains with dimensions bigger than just two or three.  Going forward our examples will get even bigger.</p>

    </subsection>

    <subsection>
        <title>Restrictions to Generalized Eigenspaces</title>

        <p>We now know how to make canonical matrix representations of a what seems to be a narrow class of linear transformations<mdash />the nilpotent ones (Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />).  However, since the restriction of any linear transformation to one of its generalized eigenspace is only a small adjustment away from being a nilpotent linear transformation  (Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" />) we can extend the utility of our previous representation easily.</p>

        <theorem xml:id="theorem-matrix-representation-restriction-generalized-eigenspace"> <!-- was MRRGE -->
            <title>Matrix Representation of a Restriction to a Generalized Eigenspace</title>
            <statement>
                <p>Suppose that <m>\ltdefn{T}{V}{V}</m> is a linear transformation with eigenvalue <m>\lambda</m>.  Then there is a basis of the the generalized eigenspace <m>\geneigenspace{T}{\lambda}</m> such that the restriction <m>\ltdefn{\restrict{T}{\geneigenspace{T}{\lambda}}}{\geneigenspace{T}{\lambda}}{\geneigenspace{T}{\lambda}}</m> has a matrix representation that is block diagonal where each block is a Jordan block of the form <m>\jordan{k}{\lambda}</m> (with varying values of <m>k</m>).</p>
            </statement>

            <proof>
                <p>Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" /> tells us that <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m> is a nilpotent linear transformation.  Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> tells us that a nilpotent linear transformation has a basis for its domain that yields a matrix representation that is block diagonal where the blocks are Jordan blocks of the form <m>\jordan{k}{0}</m>.  So let <m>B</m> be a basis of <m>\geneigenspace{T}{\lambda}</m> that yields such a matrix representation for <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m>.</p>

                <p>We can write <me>\restrict{T}{\geneigenspace{T}{\lambda}}
                =\left(\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}\right)+
                \lambda I_{\geneigenspace{T}{\lambda}}</me> Then the matrix representation of <m>\lambda I_{\geneigenspace{T}{\lambda}}</m> relative to the basis <m>B</m> is then simply the diagonal matrix <m>\lambda I_m</m>, where <m>m=\dimension{\geneigenspace{T}{\lambda}}</m>.  So we have the rather unwieldy expression,<me>\matrixrep{\restrict{T}{\geneigenspace{T}{\lambda}}}{B}{B}
                =\matrixrep{\left(\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}\right)+
                \lambda I_{\geneigenspace{T}{\lambda}}}{B}{B}
                =\matrixrep{\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}}{B}{B}
                +
                \lambda\matrixrep{I_{\geneigenspace{T}{\lambda}}}{B}{B}</me>  The first representation in the final experssion has Jordan blocks with zero in every diagonal entry by Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />, while the second representation has <m>\lambda</m> in every diagonal entry of the matrix.  The result of adding the two representations is to convert the Jordan blocks from the form <m>\jordan{k}{0}</m> to the form <m>\jordan{k}{\lambda}</m>.</p>
            </proof>
        </theorem>

        <!-- TODO: Do we need an example of Jordan blocks from generalized eigenspaces, maybe original size 4? -->

        <p>Of course, Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> provides some extra information on the sizes of the Jordan blocks in a representation and we could carry over this information to Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" />, but we will save this description and incorporate it into our final major result in the next section.</p>

    </subsection>

    <subsection xml:id="subsection-jordan-canonical-form">
        <title>Jordan Canonical Form</title>

        <p>Begin with any linear transformation that has an identical domain and codomain.  Build a block diagonal representation from a direct sum decomposition into (invariant) generalized eigenspaces.  For each generalized eigenspace, further refine the block into a sequence of Jordan blocks (with common diagonal elements) from the restriction to the generalized eigenspace, which is very nearly nilpotent.  Then you have Jordan canonical form.  Other than cosmetic reorderings, it is a unique representative of the equivalence class of similar matrices.</p>

        <p>We remove the ambiguity from trivial reorderings of eigenvalues and Jordan blocks with a careful definition.</p>

        <definition xml:id="definition-jordan-canonical-form">  <!-- was JCF -->
            <title>Jordan Canonical Form</title>
            <statement>
                <p>A square matrix is in <term>Jordan canonical form</term> if it meets the following requirements:
                <ol>
                    <li>The matrix is block diagonal.</li>
                    <li>Each block is a Jordan block.</li>
                    <li>If <m>\rho\lt\lambda</m> then the block <m>\jordan{k}{\rho}</m> occupies rows with indices greater than the indices of the rows occupied by <m>\jordan{\ell}{\lambda}</m>.</li>
                    <li>If <m>\rho=\lambda</m> and <m>\ell\lt k</m>, then the block <m>\jordan{\ell}{\lambda}</m> occupies rows with indices greater than the indices of the rows occupied by <m>\jordan{k}{\lambda}</m>.</li>
                </ol></p>
            </statement>
        </definition>

        <theorem xml:id="theorem-jordan-canonical-form"> <!-- was JCFLT -->
            <title>Jordan Canonical Form for a Linear Transformation</title>
            <statement>
                <p>Suppose <m>\ltdefn{T}{V}{V}</m> is a linear transformation.  Then there is a basis <m>B</m> for <m>V</m> such that the matrix representation of <m>T</m> with the following properties:
                <ol>
                    <li>The matrix representation is in Jordan canonical form. </li>
                    <li>If <m>\jordan{k}{\lambda}</m> is one of the Jordan blocks, then <m>\lambda</m> is an eigenvalue of <m>T</m>.</li>
                    <li>For each eigenvalue <m>\lambda</m>, the largest block of the form <m>\jordan{k}{\lambda}</m> has size equal to the index of <m>\lambda</m>, <m>\indx{T}{\lambda}</m>.</li>
                    <li>For each eigenvalue <m>\lambda</m>, the number of blocks of the form <m>\jordan{k}{\lambda}</m> is the geometric multiplicity of <m>\lambda</m>, <m>\geomult{T}{\lambda}</m>.</li>
                    <li>For each eigenvalue <m>\lambda</m>, the number of rows occupied by blocks of the form <m>\jordan{k}{\lambda}</m> is the algebraic multiplicity of <m>\lambda</m>, <m>\algmult{T}{\lambda}</m>.</li>
                </ol></p>
            </statement>

            <proof>
                <p>This theorem is really just the consequence of applying to <m>T</m>, consecutively, Theorem<nbsp /><xref ref="theorem-generalized-eigenspace-decomposition" />, Theorem<nbsp /><xref ref="theorem-matrix-representation-restriction-generalized-eigenspace" /> and Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />.</p>

                <p>Theorem<nbsp /><xref ref="theorem-generalized-eigenspace-decomposition" /> gives us a decomposition of <m>V</m> into generalized eigenspaces, one for each distinct eigenvalue.  Since these generalized eigenspaces are invariant relative to <m>T</m>, this provides a block diagonal matrix representation where each block is the matrix representation of the restriction of <m>T</m> to the generalized eigenspace.</p>

                <p>Restricting <m>T</m> to a generalized eigenspace results in a <q>nearly nilpotent</q> linear transformation, as stated more precisely in Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" />.  We unravel Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" /> in the proof of Theorem<nbsp /><xref ref="theorem-matrix-representation-restriction-generalized-eigenspace" /> so that we can apply Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> about representations of nilpotent linear transformation.</p>

                <p>We know the dimension of a generalized eigenspace is the algebraic multiplicity of the eigenvalue (Corollary<nbsp /><xref ref="corollary-generalized-eigenspace-dimension" />), so the blocks associated with the generalized eigenspaces are square with a size equal to the algebraic multiplicity.  In refining the basis for a block associatred with a single eigenvalue, and producing Jordan blocks, the results of Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> apply.  The total number of blocks will be the nullity of <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m>, which is the geometric multiplicity of <m>\lambda</m> as an eigenvalue of <m>T</m> (<acroref type="definition" acro="GME" />).  The largest of the Jordan blocks will have size equal to the index of the nilpotent linear transformation <m>\restrict{T}{\geneigenspace{T}{\lambda}}-\lambda I_{\geneigenspace{T}{\lambda}}</m>, which is exactly the definition of the index of the eigenvalue <m>\lambda</m> (Definition<nbsp /><xref ref="definition-index-eigenvalue" />).</p>
            </proof>
        </theorem>

        <p>Before we do some examples of this result, notice how close Jordan canonical form is to a diagonal matrix.  Or, equivalently, notice how close we have come to diagonalizing a matrix (<acroref type="definition" acro="DZM" />).  We have a matrix representation which has diagonal entries that are the eigenvalues of a matrix.  Each occurs on the diagonal as many times as the algebraic multiplicity.  However, when the geometric multiplicity is strictly less than the algebraic multiplicity, we have some entries in the representation just above the diagonal (the <q>superdiagonal</q>).  Furthermore, we have some idea how often this happens if we know the geometric multiplicity and the index of the eigenvalue.</p>

        <p>We now recognize just how plain a diagonalizable linear transformation really is.  For each eigenvalue, the generalized eigenspace is just the regular eigenspace, and it decomposes into a direct sum of one-dimensional subspaces, each spanned by a different eigenvector chosen from a basis of eigenvectors for the eigenspace.</p>

        <p>Some authors create matrix representations of nilpotent linear transformations where the Jordan block has the ones just below the diagonal (the <q>subdiagonal</q>).  No matter, it is really the same, just different.  We have also defined Jordan canonical form to place blocks for the larger eigenvalues earlier, and for blocks with the same eigenvalue, we place the larger sized blocks earlier.  This is fairly standard, but there is no reason we could not order the blocks differently.  It would be the same, just different.  The reason for choosing <em>some</em> ordering is to be assured that there is just <em>one</em> canonical matrix representation for each linear transformation.</p>

        <example xml:id="example-jordan-canonicalform-size-10"> <!-- was JCF10 -->
            <title>Jordan Canonical Form, Size 10</title>

            <p>Suppose that <m>\ltdefn{T}{\complex{10}}{\complex{10}}</m> is the linear transformation defined by <m>\lteval{T}{\vect{x}}=A\vect{x}</m> where <me>A=\begin{bmatrix}
             <![CDATA[-6 & 9 & -7 & -5 & 5 & 12 & -22 & 14 & 8 & 21 \\
             -3 & 5 & -3 & -1 & 2 & 7 & -12 & 9 & 1 & 12 \\
             8 & -9 & 8 & 6 & 0 & -14 & 25 & -13 & -4 & -26 \\
             -7 & 9 & -7 & -5 & 0 & 13 & -23 & 13 & 2 & 24 \\
             0 & -1 & 0 & -1 & -3 & -2 & 3 & -4 & -2 & -3 \\
             3 & 2 & 1 & 2 & 9 & -1 & 1 & 5 & 5 & -5 \\
             -1 & 3 & -3 & -2 & 4 & 3 & -6 & 4 & 4 & 3 \\
             3 & -4 & 3 & 2 & 1 & -5 & 9 & -5 & 1 & -9 \\
             0 & 2 & 0 & 0 & 2 & 2 & -4 & 4 & 2 & 4 \\
             -4 & 4 & -5 & -4 & -1 & 6 & -11 & 4 & 1 & 10]]>
            \end{bmatrix}</me></p>

            <p>We will find a basis for <m>\complex{10}</m> that will yield a matrix representation of <m>T</m> in Jordan canonical form.  First we find the eigenvalues, and their multiplicities, with the techniques of <acroref type="chapter" acro="E" />. <md>
                <mrow>\lambda&amp;=2  &amp; \algmult{T}{2}&amp;=2  &amp; \geomult{T}{2}&amp;=2</mrow>
                <mrow>\lambda&amp;=0  &amp; \algmult{T}{0}&amp;=3  &amp; \geomult{T}{-1}&amp;=2</mrow>
                <mrow>\lambda&amp;=-1 &amp; \algmult{T}{-1}&amp;=5 &amp; \geomult{T}{-1}&amp;=2</mrow>
            </md></p>

            <p>For each eigenvalue, we can compute a generalized eigenspace.  By Theorem<nbsp /><xref ref="theorem-generalized-eigenspace-decomposition" /> we know that <m>\complex{10}</m> will decompose into a direct sum of these invariant eigenspaces, and we can restrict <m>T</m> to each part of this decomposition.  At this stage we know that the Jordan canonical form will be block diagonal with blocks of size <m>2</m>, <m>3</m> and <m>5</m>, since the dimensions of the generalized eigenspaces are equal to the algebraic multiplicities of the eigenvalues (Theorem<nbsp /><xref ref="corollary-generalized-eigenspace-dimension" />).  The geometric multiplicities tell us how many Jordan blocks occupy each of the three larger blocks, but we will discuss this as we analyze each eigenvalue.  We do not yet know the index of each eigenvalue (though we can easily infer it for <m>\lambda=2</m>) and even if we did have this information, it only determines the size of the largest Jordan block (per eigenvalue).  We will press ahead, considering each eigenvalue one at a time.</p>

            <p>The eigenvalue <m>\lambda=2</m> has <q>full</q> geometric multiplicity, and is not an impediment to diagonalizing <m>T</m>.  We will treat it in full generality anyway.  First we compute the generalized eigenspace.  Since Theorem<nbsp /><xref ref="theorem-generalized-eigenspace-kernel" /> says that <m>\geneigenspace{T}{2}=\krn{\left(T-2I_{\complex{10}}\right)^{10}}</m> we can compute this generalized eigenspace as a null space derived from the matrix <m>A</m>, <md>
                <mrow>\left(A-2I_{10}\right)^{10}&amp;\rref
                \begin{bmatrix}
                <![CDATA[ 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -2 & -1 \\
                 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & -1 \\
                 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 1 & 2 \\
                 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & -1 & -2 \\
                 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & -2 & 1 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & -1 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0]]>
                \end{bmatrix}</mrow>
                <mrow>\geneigenspace{T}{2}&amp;=\krn{\left(A-2I_{10}\right)^{10}}=
                \spn{\set{
                \colvector{2 \\ 1 \\ -1 \\ 1 \\ -1 \\ 2 \\ 1 \\ 0 \\ 1 \\ 0},\,
                \colvector{1 \\ 1 \\ -2 \\ 2 \\ 0 \\ -1 \\ 0 \\ -1 \\ 0 \\ 1}
                }}</mrow>
            </md>  The restriction of <m>T</m> to <m>\geneigenspace{T}{2}</m> relative to the two basis vectors above has a matrix representation that is a <m>2\times 2</m> diagonal matrix with the eigenvalue <m>\lambda=2</m> as the diagonal entries.  So these two vectors will be the first two vectors in our basis for <m>\complex{10}</m>, <md>
                <mrow>\vect{v}_1&amp;=\colvector{2 \\ 1 \\ -1 \\ 1 \\ -1 \\ 2 \\ 1 \\ 0 \\ 1 \\ 0}
                &amp;
                \vect{v}_2&amp;=\colvector{1 \\ 1 \\ -2 \\ 2 \\ 0 \\ -1 \\ 0 \\ -1 \\ 0 \\ 1}</mrow>
            </md></p>

            <p>Notice that it was not strictly necessary to compute the 10-th power of <m>A-2I_{10}</m>.  With <m>\algmult{T}{2}=\geomult{T}{2}</m> the null space of the matrix <m>A-2I_{10}</m> contains <em>all</em> of the generalized eigenvectors of <m>T</m> for the eigenvalue <m>\lambda=2</m>.  But there was no harm in computing the 10-th power either.  This discussion is equivalent to the observation that the linear transformation <m>\ltdefn{\restrict{T}{\geneigenspace{T}{2}}}{\geneigenspace{T}{2}}{\geneigenspace{T}{2}}</m> is nilpotent of index <m>1</m>.  In other words, <m>\indx{T}{2}=1</m>.</p>

            <p>The eigenvalue <m>\lambda=0</m> will not be quite as simple, since the geometric multiplicity is strictly less than the geometric multiplicity.  As before, we first compute the generalized eigenspace.  Since Theorem<nbsp /><xref ref="theorem-generalized-eigenspace-kernel" /> says that <m>\geneigenspace{T}{0}=\krn{\left(T-0I_{\complex{10}}\right)^{10}}</m> we can compute this generalized eigenspace as a null space derived from the matrix <m>A</m>, <md>
                <mrow>\left(A-0I_{10}\right)^{10}&amp;\rref
                \begin{bmatrix}
                <![CDATA[ 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & -1 \\
                 0 & 1 & 0 & 0 & 0 & 0 & -1 & 0 & -1 & 0 \\
                 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 1 & 2 \\
                 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & -2 & -1 \\
                 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 1 & -1 & 0 & -1 & 2 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0]]>
                \end{bmatrix}</mrow>
                <mrow>\geneigenspace{T}{0}&amp;=\krn{\left(A-0I_{10}\right)^{10}}=
                \spn{\set{
                \colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0},\,
                \colvector{1 \\ 1 \\ -1 \\ 2 \\ -1 \\ 1 \\ 0 \\ -1 \\ 1 \\ 0},\,
                \colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }}
                =\spn{F}</mrow>
            </md>  So <m>\dimension{\geneigenspace{T}{0}}=3=\algmult{T}{0}</m>, as expected.  We will use these three basis vectors for the generalized eigenspace to construct a matrix representation of <m>\restrict{T}{\geneigenspace{T}{0}}</m>, where <m>F</m> is being defined implicitly as the basis of <m>\geneigenspace{T}{0}</m>.  We construct this representation as usual, applying <acroref type="definition" acro="MR" />, <md>
                <mrow>\vectrep{F}{\lteval{\restrict{T}{\geneigenspace{T}{0}}}
                {\colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0}}}&amp;=
                \vectrep{F}{\colvector{-1 \\ 0 \\ 2 \\ -1 \\ 0 \\ 2 \\ 0 \\ 0 \\ 0 \\ -1}}
                =
                \vectrep{F}{(-1)\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}}
                =\colvector{0\\0\\-1}</mrow>
                <mrow>\vectrep{F}{\lteval{\restrict{T}{\geneigenspace{T}{0}}}
                {\colvector{1 \\ 1 \\ -1 \\ 2 \\ -1 \\ 1 \\ 0 \\ -1 \\ 1 \\ 0}}}&amp;=
                \vectrep{F}{\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}}
                =
                \vectrep{F}{(1)\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}}
                =\colvector{0\\0\\1}</mrow>
                <mrow>\vectrep{F}{\lteval{\restrict{T}{\geneigenspace{T}{0}}}
                {\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}}}&amp;=
                \vectrep{F}{\colvector{0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}}
                =\colvector{0\\0\\0}</mrow>
            </md>  So we have the matrix representation <me>M=\matrixrep{\restrict{T}{\geneigenspace{T}{0}}}{F}{F}=
            \begin{bmatrix}
            <![CDATA[0 & 0 & 0 \\
            0 & 0 & 0 \\
            -1 & 1 & 0]]>
            \end{bmatrix}</me></p>

            <p>By Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" /> we can obtain a nilpotent matrix from this matrix representation by subtracting the eigenvalue from the diagonal elements, and then we can apply Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> to <m>M-(0)I_3</m>.  First check that <m>\left(M-(0)I_3\right)^2=\zeromatrix</m>, so we know that the index of <m>M-(0)I_3</m> as a nilpotent matrix, and that therefore <m>\lambda=0</m> is an eigenvalue of <m>T</m> with index <m>2</m>, <m>\indx{T}{0}=2</m>.  To determine a basis of <m>\complex{3}</m> that converts <m>M-(0)I_3</m> to canonical form, we need the null spaces of the powers of <m>M-(0)I_3</m>.  For convenience, set <m>N=M-(0)I_3</m>. <md>
                <mrow>\nsp{N^1}&amp;=\spn{\set{
                \colvector{1\\1\\0},\,\colvector{0\\0\\1}
                }}</mrow>
                <mrow>\nsp{N^2}&amp;=\spn{\set{
                \colvector{1\\0\\0},\,\colvector{0\\1\\0},\,\colvector{0\\0\\1}
                }}
                =\complex{3}</mrow>
            </md> Then we choose a vector from <m>\nsp{N^2}</m> that is not an element of <m>\nsp{N^1}</m>.  Any vector with unequal first two entries will fit the bill, say <me>\vect{z}_{2,1}=\colvector{1\\0\\0}</me> where we are employing the notation in Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />.  The next step is to multiply this vector by <m>N</m> to get part of the basis for <m>\nsp{N^1}</m>,<me>\vect{z}_{1,1}=N\vect{z}_{2,1}=
            \begin{bmatrix}
            <![CDATA[0 & 0 & 0 \\
            0 & 0 & 0 \\
            -1 & 1 & 0]]>
            \end{bmatrix}
            \colvector{1\\0\\0}=\colvector{0\\0\\-1}</me>  We need a vector to pair with <m>\vect{z}_{1,1}</m> that will make a basis for the two-dimensional subspace <m>\nsp{N^1}</m>.  Examining the basis for <m>\nsp{N^1}</m> we see that a vector with its first two entries equal will do the job. <me>\vect{z}_{1,2}=\colvector{1\\1\\0}</me> Reordering, we find the basis,<me>C=\set{\vect{z}_{1,1},\,\vect{z}_{2,1},\,\vect{z}_{1,2}}=\set{\colvector{0\\0\\-1},\,\colvector{1\\0\\0},\,\colvector{1\\1\\0}}</me></p>

            <p>From this basis, we can get a matrix representation of <m>N</m> (when viewed as a linear transformation) relative to the basis <m>C</m> for <m>\complex{3}</m>, <me>\begin{bmatrix}
            <![CDATA[0 & 1 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & 0]]>
            \end{bmatrix}
            =
            \begin{bmatrix}
            <![CDATA[\jordan{2}{0} & \zeromatrix\\
            \zeromatrix & \jordan{1}{0}]]>
            \end{bmatrix}</me>  Now we add back the eigenvalue <m>\lambda=0</m> to the representation of <m>N</m> to obtain a representation for <m>M</m>.  Of course, with an eigenvalue of zero, the change is not apparent, so we will not display the same matrix again.  This is the second block of the Jordan canonical form for <m>T</m>.  However, the three vectors in <m>C</m> will not suffice as basis vectors for the domain of <m>T</m> <mdash /> they have the wrong size!  The vectors in <m>C</m> are vectors in the domain of a linear transformation defined by the matrix <m>M</m>.  But <m>M</m> was a matrix representation of <m>\restrict{T}{\geneigenspace{T}{0}}-0I_{\geneigenspace{T}{0}}</m> relative to the basis <m>F</m> for <m>\geneigenspace{T}{0}</m>.  We need to <q>uncoordinatize</q> each of the basis vectors in <m>C</m> to produce a linear combination of vectors in <m>F</m> that will be an element of the generalized eigenspace <m>\geneigenspace{T}{0}</m>.  These will be the next three vectors of our final answer, a basis for <m>\complex{10}</m> that has a pleasing matrix representation. <md>
                <mrow>\vect{v}_3&amp;=\vectrepinv{F}{\colvector{0\\0\\-1}}=
                0\colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0}+
                0\colvector{1 \\ 1 \\ -1 \\ 2 \\ -1 \\ 1 \\ 0 \\ -1 \\ 1 \\ 0}+
                (-1)\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{-1 \\ 0 \\ 2 \\ -1 \\ 0 \\ 2 \\ 0 \\ 0 \\ 0 \\ -1}</mrow>
                <mrow>\vect{v}_4&amp;=\vectrepinv{F}{\colvector{1\\0\\0}}=
                1\colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0}+
                0\colvector{1 \\ 1 \\ -1 \\ 2 \\ -1 \\ 1 \\ 0 \\ -1 \\ 1 \\ 0}+
                0\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0}</mrow>
                <mrow>\vect{v}_5&amp;=\vectrepinv{F}{\colvector{1\\1\\0}}=
                1\colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0}+
                1\colvector{1 \\ 1 \\ -1 \\ 2 \\ -1 \\ 1 \\ 0 \\ -1 \\ 1 \\ 0}+
                0\colvector{1 \\ 0 \\ -2 \\ 1 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{1 \\ 2 \\ -1 \\ 2 \\ -1 \\ 2 \\ 1 \\ -1 \\ 1 \\ 0}</mrow>
            </md></p>

            <p>Five down, five to go.  Basis vectors, that is.  <m>\lambda=-1</m> is the smallest eigenvalue, but it will require the most computation.  First we compute the generalized eigenspace.  Since Theorem<nbsp /><xref ref="theorem-generalized-eigenspace-kernel" /> says that <m>\geneigenspace{T}{-1}=\krn{\left(T-(-1)I_{\complex{10}}\right)^{10}}</m> we can compute this generalized eigenspace as a null space derived from the matrix <m>A</m>, <md>
                <mrow>\left(A-(-1)I_{10}\right)^{10}&amp;\rref
                \begin{bmatrix}
                 <![CDATA[1 & 0 & 1 & 0 & 1 & 0 & -1 & 1 & 0 & 1 \\
                 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 0 \\
                 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 0 & -2 \\
                 0 & 0 & 0 & 0 & 0 & 1 & -2 & 1 & 0 & 2 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
                 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0]]>
                \end{bmatrix}</mrow>
                <mrow>\geneigenspace{T}{-1}&amp;=\krn{\left(A-(-1)I_{10}\right)^{10}}=
                \spn{\set{
                \colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0},\,
                \colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0},\,
                \colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0},\,
                \colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0},\,
                \colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }}
                =\spn{F}</mrow>
            </md>So <m>\dimension{\geneigenspace{T}{-1}}=5=\algmult{T}{-1}</m>, as expected.  We will use these five basis vectors for the generalized eigenspace to construct a matrix representation of <m>\restrict{T}{\geneigenspace{T}{-1}}</m>, where <m>F</m> is being recycled and defined now implicitly as the basis of <m>\geneigenspace{T}{-1}</m>.</p>

            <p>We construct this representation as usual, applying <acroref type="definition" acro="MR" />, <md>
                <mrow>&amp;\vectrep{F}{
                \lteval{\restrict{T}{\geneigenspace{T}{-1}}}
                {\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}}
                }
                =\vectrep{F}{\colvector{-1 \\ 0 \\ 0 \\ 0 \\ 0 \\ -2 \\ -2 \\ 0 \\ 0 \\ -1}}</mrow>
                <mrow>&amp;=
                \vectrep{F}{
                0\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                0\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-2)\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                0\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                (-1)\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }
                =\colvector{0\\0\\-2\\0\\-1}</mrow>
                <mrow>&amp;\vectrep{F}{
                \lteval{\restrict{T}{\geneigenspace{T}{-1}}}
                {\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}}
                }
                =\vectrep{F}{\colvector{7 \\ 1 \\ -5 \\ 3 \\ -1 \\ 2 \\ 4 \\ 0 \\ 0 \\ 3}}</mrow>
                <mrow>&amp;=
                \vectrep{F}{
                (-5)\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-1)\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                4\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                0\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                3\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }
                =\colvector{-5\\-1\\4\\0\\3}</mrow>
                <mrow>&amp;\vectrep{F}{
                \lteval{\restrict{T}{\geneigenspace{T}{-1}}}
                {\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}}
                }
                =\vectrep{F}{\colvector{1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 1}}</mrow>
                <mrow>&amp;=
                \vectrep{F}{
                (-1)\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                0\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                1\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                0\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                1\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }
                =\colvector{-1\\0\\1\\0\\1}</mrow>
                <mrow>&amp;\vectrep{F}{
                \lteval{\restrict{T}{\geneigenspace{T}{-1}}}
                {\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}}
                }
                =\vectrep{F}{\colvector{-1 \\ 0 \\ 2 \\ -2 \\ -1 \\ 1 \\ -1 \\ 1 \\ 0 \\ -2}}</mrow>
                <mrow>&amp;=
                \vectrep{F}{
                2\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-1)\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-1)\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                1\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                (-2)\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }
                =\colvector{2\\-1\\-1\\1\\-2}</mrow>
                <mrow>&amp;\vectrep{F}{
                \lteval{\restrict{T}{\geneigenspace{T}{-1}}}
                {\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}}
                }
                =\vectrep{F}{\colvector{-7 \\ -1 \\ 6 \\ -5 \\ -1 \\ -2 \\ -6 \\ 2 \\ 0 \\ -6}}</mrow>
                <mrow>&amp;=
                \vectrep{F}{
                6\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-1)\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-6)\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                2\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                (-6)\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                }
                =\colvector{6\\-1\\-6\\2\\-6}</mrow>
            </md></p>


            <p>So we have the matrix representation of the restriction of <m>T</m> (again recycling and redefining the matrix <m>M</m>) <me>M=\matrixrep{\restrict{T}{\geneigenspace{T}{-1}}}{F}{F}=\begin{bmatrix}
            <![CDATA[ 0 & -5 & -1 & 2 & 6 \\
             0 & -1 & 0 & -1 & -1 \\
             -2 & 4 & 1 & -1 & -6 \\
             0 & 0 & 0 & 1 & 2 \\
             -1 & 3 & 1 & -2 & -6]]>
            \end{bmatrix}</me></p>

            <p>Theorem<nbsp /><xref ref="theorem-restriction-generalized-eigenspace-nilpotent" /> says we can obtain a nilpotent matrix from this matrix representation by subtracting the eigenvalue from the diagonal elements, and then we can apply Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" /> to <m>M-(-1)I_5</m>.  First check that <m>\left(M-(-1)I_5\right)^3=\zeromatrix</m>, so we know that the index of <m>M-(-1)I_5</m> as a nilpotent matrix, and that therefore <m>\lambda=-1</m> is an eigenvalue of <m>T</m> with index <m>3</m>, <m>\indx{T}{-1}=3</m>.  To determine a basis of <m>\complex{5}</m> that converts <m>M-(-1)I_5</m> to canonical form, we need the null spaces of the powers of <m>M-(-1)I_5</m>.  Again, for convenience, set <m>N=M-(-1)I_5</m>. <md>
                <mrow>\nsp{N^1}&amp;=\spn{\set{
                \colvector{1 \\ 0 \\ 1 \\ 0 \\ 0},\,
                \colvector{-3 \\ 1 \\ 0 \\ -2 \\ 2}
                }}</mrow>
                <mrow>\nsp{N^2}&amp;=\spn{\set{
                \colvector{3 \\ 1 \\ 0 \\ 0 \\ 0},\,
                \colvector{1 \\ 0 \\ 1 \\ 0 \\ 0},\,
                \colvector{0 \\ 0 \\ 0 \\ 1 \\ 0},\,
                \colvector{-3 \\ 0 \\ 0 \\ 0 \\ 1}
                }}</mrow>
                <mrow>\nsp{N^3}&amp;=\spn{\set{
                \colvector{1 \\ 0 \\ 0 \\ 0 \\ 0},\,
                \colvector{0 \\ 1 \\ 0 \\ 0 \\ 0},\,
                \colvector{0 \\ 0 \\ 1 \\ 0 \\ 0},\,
                \colvector{0 \\ 0 \\ 0 \\ 1 \\ 0},\,
                \colvector{0 \\ 0 \\ 0 \\ 0 \\ 1}
                }}
                =\complex{5}</mrow>
            </md> Then we choose a vector from <m>\nsp{N^3}</m> that is not an element of <m>\nsp{N^2}</m>.  The sum of the four basis vectors for <m>\nsp{N^2}</m> sum to a vector with all five entries equal to <m>1</m>.  We will adjust with the first entry to create a vector not in <m>\nsp{N^2}</m>, <me>\vect{z}_{3,1}=\colvector{0\\1\\1\\1\\1}</me> where we are employing the notation in Theorem<nbsp /><xref ref="theorem-canonical-form-nilpotent-linear-transformation" />.  The next step is to multiply this vector by <m>N</m> to get a portion of the basis for <m>\nsp{N^2}</m>, <me>\vect{z}_{2,1}=N\vect{z}_{3,1}=\begin{bmatrix}
            <![CDATA[ 1 & -5 & -1 & 2 & 6 \\
             0 & 0 & 0 & -1 & -1 \\
             -2 & 4 & 2 & -1 & -6 \\
             0 & 0 & 0 & 2 & 2 \\
             -1 & 3 & 1 & -2 & -5]]>
            \end{bmatrix} \colvector{0\\1\\1\\1\\1}
            = \colvector{2 \\ -2 \\ -1 \\ 4 \\ -3}</me></p>


            <p>We have a basis for the two-dimensional subspace <m>\nsp{N^1}</m> and we can add to that the vector <m>\vect{z}_{2,1}</m> and we have three of four basis vectors for <m>\nsp{N^2}</m>.  These three vectors span the subspace we call <m>Q_2</m>.  We need a fourth vector outside of <m>Q_2</m> to complete a basis of the four-dimensional subspace <m>\nsp{N^2}</m>.  Check that the vector <me>\vect{z}_{2,2}=\colvector{3\\1\\3\\1\\1}</me> is an element of <m>\nsp{N^2}</m> that lies outside of the subspace <m>Q_2</m>.  This vector was constructed by getting a nice basis for <m>Q_2</m> and forming a linear combination of this basis that specifies three of the five entries of the result.  Of the remaining two entries, one was changed to move the vector outside of <m>Q_2</m> and this was followed by a change to the remaining entry to place the vector into  <m>\nsp{N^2}</m>.  The vector <m>\vect{z}_{2,2}</m> is the lone basis vector for the subspace we call <m>R_2</m>.</p>

            <p>The remaining two basis vectors are easy to come by.  They are the result of applying <m>N</m> to each of the two most recently determined basis vectors, <md>
                <mrow>\vect{z}_{1,1}&amp;=N\vect{z}_{2,1}=\colvector{3 \\ -1 \\ 0 \\ 2 \\ -2}
                &amp;
                \vect{z}_{1,2}&amp;=N\vect{z}_{2,2}=\colvector{3 \\ -2 \\ -3 \\ 4 \\ -4}</mrow>
            </md> Now we reorder these basis vectors, to arrive at the basis <me>C=\set{\vect{z}_{1,1},\,\vect{z}_{2,1},\,\vect{z}_{3,1},\,\vect{z}_{1,2},\,\vect{z}_{2,2}}
            =\set{
            \colvector{3 \\ -1 \\ 0 \\ 2 \\ -2},\,
            \colvector{2 \\ -2 \\ -1 \\ 4 \\ -3},\,
            \colvector{0 \\ 1 \\ 1 \\ 1 \\ 1},\,
            \colvector{3 \\ -2 \\ -3 \\ 4 \\ -4},\,
            \colvector{3 \\ 1 \\ 3 \\ 1 \\ 1}
            }</me>  A matrix representation of <m>N</m> relative to <m>C</m> is<me>\begin{bmatrix}
            <![CDATA[0 & 1 & 0 & 0 & 0 \\
            0 & 0 & 1 & 0 & 0 \\
            0 & 0 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 & 1 \\
            0 & 0 & 0 & 0 & 0]]>
            \end{bmatrix}=
            \begin{bmatrix}
            <![CDATA[\jordan{3}{0} & \zeromatrix \\
            \zeromatrix & \jordan{2}{0}]]>
            \end{bmatrix}</me>  To obtain a matrix representation of <m>M</m>, we add back in the matrix <m>(-1)I_5</m>, placing the eigenvalue back along the diagonal, and slightly modifying the Jordan blocks,<me>\begin{bmatrix}
            <![CDATA[-1 & 1 & 0 & 0 & 0 \\
            0 & -1 & 1 & 0 & 0 \\
            0 & 0 & -1 & 0 & 0 \\
            0 & 0 & 0 & -1 & 1 \\
            0 & 0 & 0 & 0 & -1]]>
            \end{bmatrix}
            =
            <![CDATA[\begin{bmatrix}
            \jordan{3}{-1} & \zeromatrix \\
            \zeromatrix & \jordan{2}{-1}]]>
            \end{bmatrix}</me>  The basis <m>C</m> yields a pleasant matrix representation for the <em>restriction</em> of the linear transformation <m>T-(-1)I</m> to the generalized eigenspace <m>\geneigenspace{T}{-1}</m>.  However, we must remember that these vectors in <m>\complex{5}</m> are representations of vectors in <m>\complex{10}</m> relative to the basis <m>F</m>.  Each needs to be <q>un-coordinatized</q> before joining our final basis.  Here we go, <md>
                <mrow>\vect{v}_6&amp;=\vectrepinv{F}{\colvector{3 \\ -1 \\ 0 \\ 2 \\ -2}}=
                3\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-1)\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                0\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                2\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                (-2)\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{-2 \\ -1 \\ 3 \\ -3 \\ -1 \\ 2 \\ 0 \\ 2 \\ 0 \\ -2}</mrow>
                <mrow>\vect{v}_7&amp;=\vectrepinv{F}{\colvector{2 \\ -2 \\ -1 \\ 4 \\ -3}}=
                2\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-2)\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-1)\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                4\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                (-3)\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{-2 \\ -2 \\ 2 \\ -3 \\ -2 \\ 0 \\ -1 \\ 4 \\ 0 \\ -3}</mrow>
                <mrow>\vect{v}_8&amp;=\vectrepinv{F}{\colvector{0 \\ 1 \\ 1 \\ 1 \\ 1}}=
                0\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                1\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                1\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                1\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                1\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{-2 \\ -2 \\ 0 \\ 0 \\ 1 \\ -1 \\ 1 \\ 1 \\ 0 \\ 1}</mrow>
                <mrow>\vect{v}_9&amp;=\vectrepinv{F}{\colvector{3 \\ -2 \\ -3 \\ 4 \\ -4}}=
                3\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-2)\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                (-3)\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                4\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                (-4)\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{-4 \\ -2 \\ 3 \\ -3 \\ -2 \\ -2 \\ -3 \\ 4 \\ 0 \\ -4}</mrow>
                <mrow>\vect{v}_{10}&amp;=\vectrepinv{F}{\colvector{3 \\ 1 \\ 3 \\ 1 \\ 1}}=
                3\colvector{-1 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                1\colvector{-1 \\ -1 \\ 0 \\ -1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\ 0}+
                3\colvector{1 \\ 0 \\ 0 \\ -1 \\ 0 \\ 2 \\ 1 \\ 0 \\ 0 \\ 0}+
                1\colvector{-1 \\ -1 \\ 0 \\ 0 \\ 0 \\ -1 \\ 0 \\ 1 \\ 0 \\ 0}+
                1\colvector{-1 \\ 0 \\ 0 \\ 2 \\ 0 \\ -2 \\ 0 \\ 0 \\ 0 \\ 1}
                =
                \colvector{-3 \\ -2 \\ 3 \\ -2 \\ 1 \\ 3 \\ 3 \\ 1 \\ 0 \\ 1}</mrow>
            </md>  To summarize, we list the entire basis <m>B=\set{\vectorlist{v}{10}}</m>, <md>
                <mrow>\vect{v}_1&amp;\colvector{2 \\ 1 \\ -1 \\ 1 \\ -1 \\ 2 \\ 1 \\ 0 \\ 1 \\ 0}
                &amp;
                \vect{v}_2&amp;\colvector{1 \\ 1 \\ -2 \\ 2 \\ 0 \\ -1 \\ 0 \\ -1 \\ 0 \\ 1}
                &amp;
                \vect{v}_3&amp;\colvector{-1 \\ 0 \\ 2 \\ -1 \\ 0 \\ 2 \\ 0 \\ 0 \\ 0 \\ -1}
                &amp;
                \vect{v}_4&amp;\colvector{0 \\ 1 \\ 0 \\ 0 \\ 0 \\ 1 \\ 1 \\ 0 \\ 0 \\ 0}
                &amp;
                \vect{v}_5&amp;\colvector{1 \\ 2 \\ -1 \\ 2 \\ -1 \\ 2 \\ 1 \\ -1 \\ 1 \\ 0}</mrow>

                <mrow>\vect{v}_6&amp;\colvector{-2 \\ -1 \\ 3 \\ -3 \\ -1 \\ 2 \\ 0 \\ 2 \\ 0 \\ -2}
                &amp;
                \vect{v}_7&amp;\colvector{-2 \\ -2 \\ 2 \\ -3 \\ -2 \\ 0 \\ -1 \\ 4 \\ 0 \\ -3}
                &amp;
                \vect{v}_8&amp;\colvector{-2 \\ -2 \\ 0 \\ 0 \\ 1 \\ -1 \\ 1 \\ 1 \\ 0 \\ 1}
                &amp;
                \vect{v}_9&amp;\colvector{-4 \\ -2 \\ 3 \\ -3 \\ -2 \\ -2 \\ -3 \\ 4 \\ 0 \\ -4}
                &amp;
                \vect{v}_{10}&amp;\colvector{-3 \\ -2 \\ 3 \\ -2 \\ 1 \\ 3 \\ 3 \\ 1 \\ 0 \\ 1}</mrow>
            </md>   The resulting matrix representation is <me>\matrixrep{T}{B}{B}=\begin{bmatrix}
            <![CDATA[ 2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
             0 & 2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
             0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & -1 & 1 & 0 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 0 & -1 & 1 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 0 & 0 \\
             0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -1 & 1 \\
             0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & -1]]>
            \end{bmatrix} </me></p>

            <p>If you are not inclined to check all of these computations, here are a few that should convince you of the amazing properties of the basis <m>B</m>.  Compute the matrix-vector products <m>A\vect{v}_i</m>, <m>1\leq i\leq 10</m>.  In each case the result will be a vector of the form <m>\lambda\vect{v}_i+\delta\vect{v}_{i-1}</m>, where <m>\lambda</m> is one of the eigenvalues (you should be able to predict ahead of time <em>which</em> one) and <m>\delta\in\set{0,1}</m>.</p>

            <p>Alternatively, if we can write inputs to the linear transformation <m>T</m> as linear combinations of the vectors in <m>B</m>, then the <q>action</q> of <m>T</m> is reduced to a matrix-vector product  with the exceedingly simple matrix that is the Jordan canonical form.  Wow!</p>

        </example>

        <!-- TODO: Maybe JCF needs another big example, or rather a combinatorial example? -->

    </subsection>

</section>